<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coord â€” Performance Report</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #020617;
            --card: rgba(15, 23, 42, 0.6);
            --primary: #6366f1;
            --accent: #10b981;
            --text: #f8fafc;
            --sub: #94a3b8;
            --red: #f43f5e;
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }

        body {
            margin: 0;
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(circle at 50% 50%, rgba(99, 102, 241, 0.05), transparent 80%);
            color: var(--text);
            min-height: 100vh;
            opacity: 0;
            transform: translateY(10px);
            transition: 0.6s ease-out;
        }

        body.page-loaded { opacity: 1; transform: translateY(0); }

        nav {
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
            padding: 1.2rem 10%; backdrop-filter: blur(20px);
            background: rgba(2, 6, 23, 0.8); border-bottom: 1px solid var(--border);
        }
        .logo { font-size: 1.5rem; font-weight: 800; color: #fff; letter-spacing: -1px; }
        .logo span { color: var(--primary); }
        nav div a { color: var(--sub); text-decoration: none; margin-left: 1.5rem; font-weight: 600; font-size: 0.85rem; }
        nav div a:hover { color: #fff; }

        .container { max-width: 1000px; margin: 50px auto; padding: 0 24px; }

        .header-box { margin-bottom: 40px; text-align: center; }
        .header-box h1 { font-size: 2.5rem; font-weight: 800; margin: 0; letter-spacing: -1.5px; }
        
        /* REPORT GRID */
        .report-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; }

        .report-card {
            background: var(--card); padding: 35px; border-radius: 32px;
            border: 1px solid var(--border); backdrop-filter: blur(10px);
        }

        .report-card h3 { margin: 0 0 25px 0; font-size: 1.1rem; font-weight: 700; color: var(--sub); }

        /* VISUAL BAR CHART CSS */
        .chart-container { display: flex; align-items: flex-end; gap: 15px; height: 200px; margin-top: 20px; }
        .bar-wrapper { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .bar { width: 100%; background: var(--primary); border-radius: 8px 8px 4px 4px; position: relative; min-height: 5px; }
        .bar.expense { background: var(--red); opacity: 0.7; }
        .bar.income { background: var(--accent); opacity: 0.7; }
        
        .bar-label { font-size: 10px; color: var(--sub); font-weight: 700; text-transform: uppercase; }

        /* SCORE CIRCLE */
        .score-box { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; }
        .score-circle {
            width: 150px; height: 150px; border-radius: 50%;
            border: 10px solid var(--border); display: flex;
            align-items: center; justify-content: center;
            position: relative; margin-bottom: 20px;
        }
        .score-circle span { font-size: 3rem; font-weight: 800; color: var(--primary); }
        .score-circle::after {
            content: ""; position: absolute; inset: -10px;
            border-radius: 50%; border: 10px solid var(--primary);
            clip-path: polygon(50% 50%, -50% -50%, 150% -50%); /* Simulasi progress */
        }

        .summary-text { font-size: 0.95rem; color: var(--sub); line-height: 1.6; text-align: center; }

        @media (max-width: 768px) { .report-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<nav>
    <div class="logo">C<span>oord.</span></div>
    <div>
        <a href="landing.html">Home</a>
        <a href="index.html">Dashboard</a>
        <a href="time.html">Time</a>
        <a href="finance.html">Finance</a>
        <a href="activity.html">Activity</a>
    </div>
</nav>

<div class="container">
    <div class="header-box">
        <h1>Performance Report</h1>
        <p style="color:var(--sub)">Analisis mendalam koordinasi harimu.</p>
    </div>

    <div class="report-grid">
        <div class="report-card">
            <h3>Cash Flow Comparison</h3>
            <div class="chart-container">
                <div class="bar-wrapper">
                    <div class="bar income" id="barInc" style="height: 10%;"></div>
                    <span class="bar-label">In</span>
                </div>
                <div class="bar-wrapper">
                    <div class="bar expense" id="barExp" style="height: 10%;"></div>
                    <span class="bar-label">Out</span>
                </div>
            </div>
            <p id="finAnalysis" class="summary-text" style="margin-top: 25px;"></p>
        </div>

        <div class="report-card">
            <h3>Productivity Score</h3>
            <div class="score-box">
                <div class="score-circle">
                    <span id="pScore">0</span>
                </div>
                <p id="prodAnalysis" class="summary-text"></p>
            </div>
        </div>

        <div class="report-card" style="grid-column: span 2;">
            <h3>Time Focus Allocation</h3>
            <div id="timeAnalysis" style="font-size: 1.2rem; font-weight: 600; color: var(--primary);"></div>
            <p id="timeSub" class="subtitle" style="color: var(--sub); margin-top: 10px;"></p>
        </div>
    </div>
</div>

<script>
    const today = new Date().toLocaleDateString();

    window.addEventListener('DOMContentLoaded', () => {
        setTimeout(() => document.body.classList.add('page-loaded'), 100);
        generateReport();
    });

    function generateReport() {
        // 1. Data Finance
        const finData = JSON.parse(localStorage.getItem("coord_finance")) || {};
        const todayFin = finData[today] || [];
        let inc = 0, exp = 0;
        todayFin.forEach(f => f.type === 'in' ? inc += f.amount : exp += f.amount);

        const maxFin = Math.max(inc, exp, 1);
        document.getElementById("barInc").style.height = (inc / maxFin * 100) + "%";
        document.getElementById("barExp").style.height = (exp / maxFin * 100) + "%";
        
        const finMsg = inc > exp ? "Kondisi keuangan sehat. Pemasukan lebih besar dari pengeluaran." : "Waspada! Pengeluaranmu membengkak hari ini.";
        document.getElementById("finAnalysis").textContent = finMsg;

        // 2. Data Productivity (Activity)
        const actData = JSON.parse(localStorage.getItem("coord_activities")) || {};
        const todayActs = actData[today] || [];
        const completed = todayActs.filter(a => a.done).length;
        const score = todayActs.length ? Math.round((completed / todayActs.length) * 100) : 0;

        document.getElementById("pScore").textContent = score;
        document.getElementById("prodAnalysis").textContent = `Kamu menyelesaikan ${completed} dari ${todayActs.length} tugas hari ini.`;

        // 3. Data Time
        const timeData = JSON.parse(localStorage.getItem("coord_time")) || {};
        const todayTime = timeData[today] || [];
        let totalH = 0;
        todayTime.forEach(t => totalH += t.hours);

        document.getElementById("timeAnalysis").textContent = `Total Fokus: ${totalH.toFixed(1)} Jam`;
        document.getElementById("timeSub").textContent = totalH > 5 ? "Luar biasa! Kamu sangat produktif hari ini." : "Ayo tingkatkan lagi jam fokusmu besok.";
    }
</script>
</body>
</html>