<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coord â€” Smart Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { 
            --bg: #030712; 
            --card: rgba(17, 24, 39, 0.7); 
            --primary: #6366f1; 
            --accent: #10b981; 
            --text: #f9fafb; 
            --sub: #9ca3af; 
            --red: #ef4444; 
            --border: rgba(255, 255, 255, 0.05);
            --glow: rgba(99, 102, 241, 0.2);
        }

        * { box-sizing: border-box; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        body { 
            margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); 
            opacity: 0; transform: scale(0.98); transition: 0.8s ease;
            background-image: 
                radial-gradient(circle at 0% 0%, rgba(99, 102, 241, 0.15) 0px, transparent 40%),
                radial-gradient(circle at 100% 100%, rgba(16, 185, 129, 0.1) 0px, transparent 40%);
        }
        body.loaded { opacity: 1; transform: scale(1); }

        nav { 
            position: sticky; top: 0; z-index: 100; display: flex; justify-content: space-between; align-items: center; 
            padding: 1rem 8%; backdrop-filter: blur(25px); background: rgba(3, 7, 18, 0.6); 
            border-bottom: 1px solid var(--border); 
        }
        .logo { font-size: 1.6rem; font-weight: 800; letter-spacing: -1.5px; background: linear-gradient(to right, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        nav div a { color: var(--sub); text-decoration: none; margin-left: 2rem; font-weight: 600; font-size: 0.85rem; position: relative; }
        nav div a.active { color: #fff; }
        nav div a.active::after { content: ''; position: absolute; bottom: -5px; left: 0; width: 100%; height: 2px; background: var(--primary); border-radius: 10px; }

        .container { max-width: 1200px; margin: 40px auto; padding: 0 24px; }
        
        /* ANALYTICS HEADER */
        .analytics-header { 
            display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 20px; margin-bottom: 40px; 
        }
        
        .glass-panel { 
            background: var(--card); border: 1px solid var(--border); border-radius: 35px; 
            padding: 30px; backdrop-filter: blur(15px); position: relative; overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .glass-panel:hover { border-color: var(--primary); box-shadow: 0 15px 45px var(--glow); transform: translateY(-5px); }

        .chart-box { display: flex; align-items: flex-end; gap: 12px; height: 100px; margin-top: 15px; }
        .bar-ui { flex: 1; border-radius: 12px; min-height: 8px; position: relative; }

        .score-display { font-size: 3.5rem; font-weight: 800; background: linear-gradient(to bottom, #fff, var(--primary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* BENTO GRID */
        .bento-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .bento-item { 
            background: var(--card); border: 1px solid var(--border); border-radius: 30px; 
            padding: 25px; backdrop-filter: blur(10px);
        }
        .span-2 { grid-column: span 2; }
        
        .item-label { color: var(--sub); font-size: 0.75rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 10px; display: block; }
        .item-value { font-size: 1.8rem; font-weight: 800; display: block; }

        .feed-container { height: 280px; overflow-y: auto; margin-top: 15px; }
        .feed-container::-webkit-scrollbar { width: 0; }
        
        .feed-card { 
            padding: 15px; background: rgba(255,255,255,0.03); border-radius: 20px; 
            margin-bottom: 12px; border: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center;
        }

        /* --- RESPONSIVE FIX (HP) --- */
        @media (max-width: 900px) {
            nav { padding: 1rem 5%; flex-direction: column; gap: 15px; text-align: center; }
            nav div a { margin: 0 10px; font-size: 0.75rem; }
            .analytics-header { grid-template-columns: 1fr; }
            .bento-grid { grid-template-columns: 1fr; }
            .span-2 { grid-column: span 1; }
            .container { margin: 20px auto; }
            h1 { font-size: 2.2rem !important; }
            .score-display { font-size: 2.8rem; }
        }
    </style>
</head>
<body>

<nav>
    <div class="logo">C<span>oord.</span></div>
    <div>
        <a href="index.html">Home</a>
        <a href="dashboard.html" class="active">Dashboard</a>
        <a href="time.html">Time</a>
        <a href="finance.html">Finance</a>
        <a href="activity.html">Activity</a>
        <a href="profile.html">Profile</a>
    </div>
</nav>

<div class="container">
    <header style="margin-bottom: 40px;">
        <h1 style="font-size: 2.8rem; font-weight: 800; margin: 0; letter-spacing: -2px;">The Core<span>.</span></h1>
        <p style="color:var(--sub); margin-top:5px;">Sinkronisasi data otomatis dari semua modul aktif.</p>
    </header>

    <section class="analytics-header">
        <div class="glass-panel">
            <span class="item-label">Cash Flow Velocity</span>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2 id="finStatus" style="margin:0; font-size: 1.5rem;">Ready</h2>
                <div class="chart-box" style="width: 120px;">
                    <div id="barIn" class="bar-ui" style="background:var(--accent)"></div>
                    <div id="barOut" class="bar-ui" style="background:var(--red)"></div>
                </div>
            </div>
            <p style="font-size: 0.85rem; color: var(--sub); margin-top: 15px;">Perbandingan arus kas masuk & keluar hari ini.</p>
        </div>

        <div class="glass-panel" style="text-align: center;">
            <span class="item-label">Efforts Score</span>
            <div class="score-display" id="prodScore">0%</div>
            <p style="font-size: 0.85rem; color: var(--sub);">Aktivitas yang berhasil diselesaikan.</p>
        </div>

        <div class="glass-panel" style="background: linear-gradient(135deg, var(--primary), #4338ca);">
            <span class="item-label" style="color: rgba(255,255,255,0.7);">Active Focus</span>
            <div style="font-size: 3.5rem; font-weight: 800;" id="dashHours">0.0</div>
            <p style="font-size: 0.85rem; color: rgba(255,255,255,0.7);">Jam produktif terekam hari ini.</p>
        </div>
    </section>

    <section class="bento-grid">
        <div class="bento-item span-2">
            <span class="item-label">Live Activity Lab</span>
            <div class="feed-container" id="dashActivityList"></div>
        </div>
        <div class="bento-item span-2">
            <span class="item-label">Upcoming Time Blocks</span>
            <div class="feed-container" id="dashTimeList"></div>
        </div>
        <div class="bento-item">
            <span class="item-label">Pemasukan</span>
            <span class="item-value" id="dashInc" style="color:var(--accent)">Rp0</span>
        </div>
        <div class="bento-item">
            <span class="item-label">Pengeluaran</span>
            <span class="item-value" id="dashExp" style="color:var(--red)">Rp0</span>
        </div>
        <div class="bento-item span-2" style="background: rgba(255,255,255,0.02);">
            <span class="item-label">Net Financial Balance</span>
            <span class="item-value" id="dashBalance">Rp0</span>
        </div>
    </section>
</div>

<script>
    window.onload = () => {
        document.body.classList.add('loaded');
        const today = new Date().toLocaleDateString();
        const f = (n) => "Rp" + new Intl.NumberFormat('id-ID').format(n);
        
        // Proteksi: Jika belum login, ke login.html
        if(!localStorage.getItem("coord_user")) {
            window.location.href = "login.html";
            return;
        }

        // Data Finance
        const finData = JSON.parse(localStorage.getItem("coord_finance")) || {};
        let inc = 0, exp = 0; 
        (finData[today] || []).forEach(x => { if(x.type === "in") inc += x.amount; else exp += x.amount; });
        const max = Math.max(inc, exp, 1);
        document.getElementById("barIn").style.height = (inc/max*100) + "%";
        document.getElementById("barOut").style.height = (exp/max*100) + "%";
        document.getElementById("finStatus").textContent = inc >= exp ? "Bullish" : "Bearish";
        document.getElementById("dashInc").textContent = f(inc);
        document.getElementById("dashExp").textContent = f(exp);
        const bal = inc - exp;
        document.getElementById("dashBalance").textContent = f(bal);
        document.getElementById("dashBalance").style.color = bal < 0 ? "var(--red)" : "var(--accent)";

        // Data Activity
        const actData = JSON.parse(localStorage.getItem("coord_activities")) || {};
        const acts = actData[today] || [];
        const score = acts.length ? Math.round(acts.filter(a => a.done).length/acts.length*100) : 0;
        document.getElementById("prodScore").textContent = score + "%";
        document.getElementById("dashActivityList").innerHTML = acts.map(a => `
            <div class="feed-card">
                <span style="font-weight:600">${a.text}</span>
                <span style="font-size:0.7rem; color:${a.done ? 'var(--accent)' : 'var(--sub)'}">${a.done ? 'COMPLETED' : 'IN PROGRESS'}</span>
            </div>
        `).join("");
        
        // Data Time
        const timeData = JSON.parse(localStorage.getItem("coord_time")) || {};
        let totalH = 0; 
        (timeData[today] || []).forEach(t => totalH += t.hours);
        document.getElementById("dashHours").textContent = totalH.toFixed(1);
        document.getElementById("dashTimeList").innerHTML = (timeData[today] || []).map(t => `
            <div class="feed-card">
                <span style="font-weight:600">${t.name}</span>
                <span style="font-size:0.7rem; color:var(--primary)">${t.time}</span>
            </div>
        `).join("");
    }
</script>
</body>
</html>
